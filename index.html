<!doctype html>
<html>
<head>
    <title>latruncularius</title>
    <link rel="stylesheet" href="/css/chessboard-0.3.0.css"/>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script src="/js/chessboard-0.3.0.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        /*$(function () {
            const socket = io();
            const config = {
                position: 'start',
                draggable: true,
                onDrop: onDrop
            };

            function onDrop(source, target, piece, newPos, oldPos, orientation) {
                socket.emit('board fen', ChessBoard.objToFen(newPos));
            };

            socket.on('board fen', fen => {
                board1.position(fen);
            });

            const board1 = ChessBoard('board1', config);
        });*/

        const socket = io();
        let room;
        socket.emit('room', room);

        function newRoom(){
            room = prompt("Room ID");
            socket.emit('room', room);
        }

        $(function () {
            const config = {
                position: 'start',
                draggable: true,
                onDrop: onDrop
            };

            function onDrop(source, target, piece, newPos, oldPos, orientation) {
                socket.emit('board fen', [room, ChessBoard.objToFen(newPos)]);
            };

            socket.on('new pos', pos => {
                board.position(pos);
            });

            const board = ChessBoard('board', config);
        });
    </script>
</head>
<body>
    <div id="board" style="width: 400px"></div>
    <button onclick="newRoom()">New room</button>
</body>
</html>

<!--<html>
    <head>
        <script src="/socket.io/socket.io.js"></script>
        <link rel="stylesheet" type="text/css" href="/css/chessboard-0.3.0.css">
        <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
        <script>
            $(function () {
                const socket = io();
                $('form').submit(function(e){
                    e.preventDefault(); // prevents page reloading
                    socket.emit('chat message', $('#m').val());
                    $('#m').val('');
                    return false;
                });
                socket.on('chat message', function(msg){
                    $('#messages').append($('<li>').text(msg));
                });
            });

        </script>
    </head>
    <body>
    <ul id="messages"></ul>
    <form action="">
        <input id="m" autocomplete="off" /><button>Send</button>
    </form>
    </body>
</html>-->